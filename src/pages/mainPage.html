<div class="carouselBox">
    <div id="carouselExampleCaptions" class="carousel slide" data-ride="carousel">
        <ol class="carousel-indicators">
            <li data-target="#carouselExampleCaptions" data-slide-to="0" class="active"></li>
            <li data-target="#carouselExampleCaptions" data-slide-to="1"></li>
            <li data-target="#carouselExampleCaptions" data-slide-to="2"></li>
        </ol>
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="./dist/images/man08.png" class="d-block w-100" alt="...">
                <div class="carouselTxtBox carousel-caption d-md-block" onclick="switchPage('preferPage')">
                    <h5>最新優利專案</h5>
                    <p>前三個月固定利率1.68%<br />第四個月機動利率2.5%起</p>
                </div>
            </div>
            <div class="carousel-item">
                <img src="./dist/images/demo03.jpg" class="d-block w-100" alt="...">
                <div class="carouselTxtBox carousel-caption d-md-block"  onclick="switchPage('secondOrderLoan')">
                    <h5>二順位貸款</h5>
                    <p>貸款額度可高於信用貸款<br />取得資金速度比房屋貸款快</p>
                </div>
            </div>
            <div class="carousel-item">
                <img src="./dist/images/demo05.jpg" class="d-block w-100" alt="...">
                <div class="carouselTxtBox carousel-caption d-md-block"  onclick="switchPage('creditLoanPage')">
                    <h5>個人信用貸款</h5>
                    <p>個人信貸免押、免保、免照會<br />讓您的資金運作更加靈活。</p>
                </div>
            </div>
        </div>
        <a class="carousel-control-prev" href="#carouselExampleCaptions" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleCaptions" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
    </div>
</div>


<div class="container mt-3">
    <div class="row">
        <div class="col-md-4 col-12 newsBox">
            <h3>最新消息</h3>
            <ul id="nt-title">
                <li><span onclick="openQAModel('1')">本身在銀行信用有瑕疵可以辦理嗎？</span></li>
                <li><span onclick="openQAModel('2')">有車子可是想借錢，要向誰借呢？</span></li>
                <li><span onclick="openQAModel('3')">申請貸款人需要有什麼條件呢？</span></li>
                <li><span onclick="openQAModel('4')">汽車貸款有什麼優點？</span></li>
                <li><span onclick="openQAModel('5')">借二胎房貸，需要提供什麼資訊？</span></li>
                <li><span onclick="openQAModel('6')">什麼狀況會需要申辦信用貸款?</span></li>
            </ul>
        </div>
        <div class="col-md-8 col-12 serviceBox">
            <h3 class="typewrite" data-period="3500" data-type='[ "3大服務","快速審核" ]'></h3>
            <div class="info mt-2 d-flex"><span>信用借貸</span><span>汽車借貸</span><span>資金周轉</span></div>
            <div class="infotxt">
                實際貸款條件，仍以銀行提供之產品為準，且每一顧客實際之年百分率仍以其個別貸款產品及授信條件而有所不同。
                歡迎聯繫我們專業的服務團隊來為您解答。
            </div>
        </div>
    </div>
</div>

<div class="container mt-3 " id="scrollAniTarOne">
    <div class="row mainServiceBox">
        <div class="col-md-3 col-12 mainServiceBoxItem">
            <h3>最新優利專案</h3>
            <p>貸款額度: 新台幣最高100萬元<br>貸款利率: 月利率1.68%起<br>貸款期間: 最長7年<br>貸款費用: 6,000元<br>準備文件:
                身分證、財力證明文件<br>(所得稅扣繳憑單、薪轉存摺封面及近半年內頁、薪資證明、報稅資料擇一即可)</p>
        </div>
        <div class="col-md-3 col-12 mainServiceBoxItem">
            <h3>個人信用貸款</h3>
            <p>貸款額度: 新台幣最高100萬元<br>
                貸款利率: 月利率1.68%起<br>
                貸款期間: 最長7年<br>
                貸款費用: 6,000元<br>
                準備文件: 身分證、財力證明文件<br>
                (所得稅扣繳憑單、薪轉存摺封面及近半年內頁、薪資證明、報稅資料擇一即可)</p>
        </div>
        <div class="col-md-3 col-12 mainServiceBoxItem">
            <h3>二順位貸款</h3>
            <p>貸款額度: 新台幣50萬元以上<br>
                貸款利率: 年利率2.5%~9.88%<br>
                貸款期間: 最長可達15年<br>
                貸款費用: 貸款金額的1%起<br>
                準備文件: 身分證、財力證明文件<br>
                (所得稅扣繳憑單、薪轉存摺封面及近半年內頁、薪資證明、報稅資料擇一即可)</p>
        </div>
        <div class="col-md-3 col-12 mainServiceBoxItem">
            <h3>汽車貸款</h3>
            <p>
                貸款額度: 新台幣300萬元以上<br>
                貸款利率: 年利率2.5%~9.88%<br>
                貸款期間: 最長可達7年<br>
                貸款費用: 貸款金額的1%起<br>
                準備文件: 身分證、財力證明文件<br>
                (所得稅扣繳憑單、薪轉存摺封面及近半年內頁、薪資證明、報稅資料擇一即可)</p>
        </div>
    </div>
</div>

<div class="container mt-3 pb-3 brandPromoteBox">
    <div class="row">
        <div class="col-12 title">
            <h3 class="typewrite" data-period="2000" data-type='[ "客戶肯定","專業安心" ]'></h3>
        </div>
        <div class="w-100"></div>
        <div class="col-md-4 col-12 imgBox">
            <img src="./dist/images/man01.png" alt="">
        </div>
        <div class="col-md-8 col-12 promoteItems">
            <div class="row">
                <div class="col-md-6 col-6 pItem"><span><i class="fab fa-facebook-f"></i></span>1450件專案成功</div>
                <div class="col-md-6 col-6 pItem"><span><i class="fas fa-thumbs-up"></i></span>1864名顧客推薦</div>
                <div class="col-md-6 col-6 pItem"><span><i class="fas fa-shield-alt"></i></span>1280座得名獎項</div>
                <div class="col-md-6 col-6 pItem"><span><i class="fab fa-black-tie"></i></span>48名菁英成員</div>
            </div>
        </div>
    </div>
</div>

<script>
    function textAnimation() {
        var elements = document.getElementsByClassName('typewrite');
        for (var i = 0; i < elements.length; i++) {
            var toRotate = elements[i].getAttribute('data-type');
            var period = elements[i].getAttribute('data-period');
            if (toRotate) {
                new TxtType(elements[i], JSON.parse(toRotate), period);
            }
        }
        // INJECT CSS
        var css = document.createElement("style");
        css.type = "text/css";
        css.innerHTML = ".typewrite > .wrap { padding:0px 10px;";
        document.body.appendChild(css);
    }

    var TxtType = function (el, toRotate, period) {
        this.toRotate = toRotate;
        this.el = el;
        this.loopNum = 0;
        this.period = parseInt(period, 10) || 2000;
        this.txt = '';
        this.tick();
        this.isDeleting = false;
    };

    TxtType.prototype.tick = function () {
        var i = this.loopNum % this.toRotate.length;
        var fullTxt = this.toRotate[i];

        if (this.isDeleting) {
            this.txt = fullTxt.substring(0, this.txt.length - 1);
        } else {
            this.txt = fullTxt.substring(0, this.txt.length + 1);
        }

        this.el.innerHTML = '<span class="wrap">' + this.txt + '</span>';

        var that = this;
        var delta = 200 - Math.random() * 100;

        if (this.isDeleting) { delta /= 2; }

        if (!this.isDeleting && this.txt === fullTxt) {
            delta = this.period;
            this.isDeleting = true;
        } else if (this.isDeleting && this.txt === '') {
            this.isDeleting = false;
            this.loopNum++;
            delta = 500;
        }

        setTimeout(function () {
            that.tick();
        }, delta);
    };


    function startAni() {
        let scrollYtop = $(window).scrollTop();
        let startPointOne = $('#scrollAniTarOne').scrollTop() + 150;
        if (scrollYtop >= startPointOne) {
            var tarAni = $('.mainServiceBoxItem');
            tarAni.each(function (index) {
                let times = 500 * index;
                setTimeout(() => {
                    $(this).addClass('scale-up-center')
                }, times)
            })
        }
    }

    textAnimation();
    document.addEventListener('turbolinks:load', function () { FontAwesome.dom.i2svg() });
    document.addEventListener('scroll', startAni, false);
    $('#nt-title').newsTicker({
        row_height: 44,
        max_rows: 3,
        duration: 3000,
        pauseOnHover: 1
    });

    function openQAModel(dataIndex){
        for(let i=0;i<QAlist.length;i++){
            if(dataIndex == QAlist[i].id){
                let title = QAlist[i].qTitle;
                let content =QAlist[i].aContent;
                $('#QAModal .modal-title').html(title);
                $('#QAModal .modal-body').html(content);
                $('#QAModal').modal('show');
                return true;
            }
        }
    }

</script>